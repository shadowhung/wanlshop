(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-money-pay"],{"2aed":function(e,t,i){"use strict";i.r(t);var n=i("9af4"),a=i("c848");for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);i("99f5");var c,s=i("f0c5"),d=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"250d67d8",null,!1,n["a"],c);t["default"]=d.exports},"2c67":function(e,t,i){"use strict";var n=i("4733"),a=i.n(n);a.a},"2f1a":function(e,t,i){var n=i("3812");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("001fa319",n,!0,{sourceMap:!1,shadowMode:!1})},3812:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,".numberkeyboard[data-v-250d67d8]{position:fixed;width:100%;bottom:0}.numberkeyboard .title[data-v-250d67d8]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:%?50?%;background:#f9f9f9}.numberkeyboard .keys[data-v-250d67d8]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap}.numberkeyboard .keys .key[data-v-250d67d8]{width:%?250?%;height:%?120?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;border-right:1px solid #f5f5f5;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:%?40?%}.numberkeyboard .keys .key[data-v-250d67d8]:nth-child(n + 4){border-top:1px solid #f5f5f5;-webkit-box-sizing:border-box;box-sizing:border-box}.numberkeyboard .keys .key[data-v-250d67d8]:active{background:#ddd}.iPhonex[data-v-250d67d8]{padding-bottom:calc(env(safe-area-inset-bottom) * 1.5);background-color:#f5f5f5}.keys .key[data-v-250d67d8]{background-color:#fff}",""]),e.exports=t},"3f78":function(e,t,i){"use strict";i.r(t);var n=i("fe00"),a=i("40ad");for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);i("2c67");var c,s=i("f0c5"),d=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"2cd5fe7c",null,!1,n["a"],c);t["default"]=d.exports},"40ad":function(e,t,i){"use strict";i.r(t);var n=i("4549"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},4549:function(e,t,i){"use strict";(function(e){var n=i("4ea4");i("4160"),i("a15b"),i("d81d"),i("a434"),i("acd8"),i("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var a=n(i("1da1")),o=n(i("5530")),c=i("2f62"),s={data:function(){return{loading:!1,disabled:!1,price:"0.00",isbalance:!1,order_no:"",order_pay_no:"",payNum:1,payList:[],config:{count:[{index:1,key:"valid-code-input-1"},{index:2,key:"valid-code-input-2"},{index:3,key:"valid-code-input-3"},{index:4,key:"valid-code-input-4"},{index:5,key:"valid-code-input-5"},{index:6,key:"valid-code-input-6"}]},keyboardVisible:!0,currentFocus:1,mobile:"",code:[],style:{inputWidth:"40upx",inputHeight:"100upx"},countdown:60,cTimer:null,event:"",pageroute:""}},computed:(0,o.default)({},(0,c.mapState)(["user"])),watch:{price:function(e,t){e<=parseFloat(this.$store.state.user.money)&&(this.isbalance=!0,this.getPayment())}},onLoad:function(t){var i=this;if(this.$api.post({url:"/wanlshop/pay/getBalance",success:function(e){i.$store.commit("user/setUserInfo",{money:e}),i.getPayment()}}),t.data){var n=0,a=JSON.parse(t.data),o=[];a.length<=1?(this.price=a[0].price,this.order_no="訂單號："+a[0].order_no,this.order_pay_no=a[0].pay_no,this.order_id=a[0].order_id):(a.forEach((function(e){n=i.$wanlshop.bcadd(n,e.price),o.push(e.order_id)})),this.price=n,this.order_id=o,this.payNum=a.length,this.order_no="合併支付 "+a.length+"個訂單")}else t.order_id?(uni.showLoading({title:"結算中..."}),this.$api.post({url:"/wanlshop/pay/getPay",data:{order_id:t.order_id},success:function(e){uni.hideLoading(),i.price=e.price,i.order_no="訂單號："+e.order_no,i.order_pay_no=e.pay_no,i.order_id=e.order_id}})):e.log("非法訪問")},methods:{getPayment:function(){this.payList=[{name:"餘額支付",describe:"",type:"balance",method:"balance",state:!!this.isbalance,select:!!this.isbalance}],this.payList.push()},confirm:function(){if(this.currentFocus<6)return this.$wanlshop.msg("請輸入支付密碼"),this.keyboardVisible=!0,!1;var e=null;this.disabled||(this.payList.map((function(t,i,n){t.select&&(e=t)})),e?(this.loading=!0,this.disabled=!0,this.wanlPay(e)):uni.showModal({content:"請選擇支付方式",showCancel:!1}))},wanlPay:function(t){var i=arguments,n=this;return(0,a.default)(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:o=i.length>1&&void 0!==i[1]?i[1]:null,n.$api.post({url:"/wanlshop/pay/payment",data:{type:t.type,method:t.method,captcha:n.code.join(""),code:o,order_id:n.order_id},success:function(i){if("balance"==t.type&&(n.loading=!1,n.$store.commit("user/setUserInfo",{money:n.$wanlshop.bcsub(n.$store.state.user.money,n.price)}),n.paySuccess()),"wechat"==t.type&&"wap"==t.method&&(n.loading=!1,uni.showModal({title:"微信支付",content:"是否已完成支付",success:function(t){t.confirm?n.paySuccess():t.cancel&&e.log("用戶點擊取消")}}),window.location.href=i),"alipay"==t.type&&"wap"==t.method&&(n.loading=!1,n.$store.commit("statistics/order",{pay:n.$wanlshop.bcsub(n.$store.state.statistics.order.pay,n.payNum),delive:n.$wanlshop.bcadd(n.$store.state.statistics.order.delive,n.payNum)}),document.write(i)),"wechat"==t.type&&"miniapp"==t.method&&uni.requestPayment({appId:i.appId,nonceStr:i.nonceStr,package:i.package,paySign:i.paySign,signType:i.signType,timeStamp:i.timeStamp,success:function(e){n.paySuccess()},fail:function(e){uni.showModal({content:"支付失敗,原因為: "+e.errMsg,showCancel:!1})}}),("alipay"==t.type||"wechat"==t.type)&&"app"==t.method){var a=t.type;"wechat"==t.type&&(a="wxpay"),uni.requestPayment({provider:a,orderInfo:i,success:function(t){e.log("success",t),n.paySuccess()},fail:function(e){uni.showModal({content:"支付失敗,原因為: "+e.errMsg,showCancel:!1})},complete:function(){n.loading=!1,n.disabled=!1}})}}});case 2:case"end":return a.stop()}}),a)})))()},onSelect:function(e){this.payList.map((function(t,i,n){t.select=i==e&&!t.select}))},inputCode:function(e){var t=this;this.code[this.currentFocus-1]=e,6==this.currentFocus&&this.$api.post({url:"/wanlshop/pay/getpaypass",data:{captcha:this.code.join("")},success:function(e){t.confirm()}}),this.currentFocus<=6&&this.currentFocus++},deleteCode:function(){this.currentFocus--,this.code.splice(-1,1)},emptyCode:function(){this.code=[],this.currentFocus=0},hanldeOpenKeyboard:function(){this.keyboardVisible=!0},paySuccess:function(){this.loading=!1,this.$store.commit("statistics/order",{pay:this.$wanlshop.bcsub(this.$store.state.statistics.order.pay,this.payNum),delive:this.$wanlshop.bcadd(this.$store.state.statistics.order.delive,this.payNum)}),this.$wanlshop.to("/pages/page/success?type=pay")}}};t.default=s}).call(this,i("5a52")["default"])},4733:function(e,t,i){var n=i("b84f");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("72b2d605",n,!0,{sourceMap:!1,shadowMode:!1})},"99f5":function(e,t,i){"use strict";var n=i("2f1a"),a=i.n(n);a.a},"9af4":function(e,t,i){"use strict";var n;i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.numberKeyboardPopupVisible,expression:"numberKeyboardPopupVisible"}],staticClass:"numberkeyboard",attrs:{id:"number-keyboard-component"}},[i("v-uni-view",{staticClass:"title",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}},[i("v-uni-image",{staticStyle:{width:"30upx",height:"30upx"},attrs:{src:e.$wanlshop.appstc("/common/img_down3x.png")}})],1),i("v-uni-view",{staticClass:"keys"},[e._l(e.config.loop,(function(t){return i("v-uni-view",{key:t.key,staticClass:"key button",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.number(t.number)}}},[e._v(e._s(t.number))])})),i("v-uni-view",{staticClass:"key button",staticStyle:{background:"#f5f5f5"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.empty.apply(void 0,arguments)}}},[i("v-uni-image",{staticStyle:{width:"50upx",height:"50upx"},attrs:{src:e.$wanlshop.appstc("/common/img_empty3x.png")}})],1),i("v-uni-view",{staticClass:"key button",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.number(0)}}},[e._v("0")]),i("v-uni-view",{staticClass:"key button",staticStyle:{background:"#f5f5f5"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.del.apply(void 0,arguments)}}},[i("v-uni-image",{staticStyle:{width:"50upx",height:"50upx"},attrs:{src:e.$wanlshop.appstc("/common/img_delete3x.png")}})],1)],2),i("v-uni-view",{staticClass:"iPhonex"})],1)},o=[]},b84f:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,"uni-page-body[data-v-2cd5fe7c]{background-color:#fff}.wanl-title[data-v-2cd5fe7c]{padding-bottom:%?130?%;padding-top:%?170?%;font-size:%?68?%}.wanl-title .titleInfo[data-v-2cd5fe7c]{font-size:%?56?%}.wanl-weixin-btn-info[data-v-2cd5fe7c]{color:#b8b8b8!important}.auth[data-v-2cd5fe7c]{margin:0 %?60?%}.auth-group[data-v-2cd5fe7c]{padding:%?1?% %?30?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;min-height:%?90?%;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-bottom:%?25?%}.auth-group uni-input[data-v-2cd5fe7c]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:%?33?%;color:#250f00;padding-right:%?20?%}.auth-group .placeholder[data-v-2cd5fe7c]{color:#b3b3b3}.auth-button[data-v-2cd5fe7c]{padding:%?25?% 0 %?50?% 0}.auth-button .cu-btn[data-v-2cd5fe7c]{height:%?90?%}.text-center[data-v-2cd5fe7c]{color:#3f2f21\n}.auth-clause[data-v-2cd5fe7c]{font-size:%?25?%;color:#909090}.auth-clause uni-text[data-v-2cd5fe7c]{margin:0 %?10?%;color:#ed6d0f}.auth-foot[data-v-2cd5fe7c]{position:fixed;width:100%;bottom:0;z-index:1024;padding:0 %?60?%;padding-bottom:calc(env(safe-area-inset-bottom) / 2)}.auth-foot .oauth[data-v-2cd5fe7c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-webkit-align-items:center;align-items:center;min-height:%?160?%;-webkit-justify-content:space-around;justify-content:space-around}.auth-foot .oauth uni-view[data-v-2cd5fe7c]{border:%?2?% solid #fcf7e9}.auth-foot .menu[data-v-2cd5fe7c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;margin-bottom:%?100?%;color:#3f2f21;line-height:%?28?%;font-size:%?28?%}.auth-foot uni-text[data-v-2cd5fe7c]{width:%?180?%;text-align:center}.auth-foot uni-text[data-v-2cd5fe7c]:nth-child(2){border-left:1px solid #ececec}\r\n\r\n/* 驗證碼 */.auth-title[data-v-2cd5fe7c]{padding-bottom:%?30?%;padding-top:%?170?%;font-size:%?60?%}.auth-mobile[data-v-2cd5fe7c]{color:#9a9a9a;padding-bottom:%?80?%}.auth-mobile uni-text[data-v-2cd5fe7c]{margin-left:%?10?%}.codes[data-v-2cd5fe7c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-around;justify-content:space-around;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.codes uni-input[data-v-2cd5fe7c]{background:#fff;border-bottom:1px solid #c3c3c3;width:%?90?%;height:%?90?%;text-align:center}.codes .input[data-v-2cd5fe7c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background:#fff;border-bottom:1px solid #c3c3c3;width:%?90?%;height:%?90?%;font-size:%?40?%;font-weight:500;color:#333}.codes .input .shining[data-v-2cd5fe7c]{border:1px solid #ed6d0f;height:%?50?%;animation:shining-data-v-2cd5fe7c 1s linear infinite;\r\n\t/* 其它瀏覽器兼容性前缀 */-webkit-animation:shining-data-v-2cd5fe7c 1s linear infinite;-moz-animation:shining-data-v-2cd5fe7c 1s linear infinite;-ms-animation:shining-data-v-2cd5fe7c 1s linear infinite;-o-animation:shining-data-v-2cd5fe7c 1s linear infinite}.codes .active[data-v-2cd5fe7c]{border-bottom:1px solid #ed6d0f;caret-color:#ed6d0f}.oneline-codes uni-input[data-v-2cd5fe7c]{text-align:center}.auth-again[data-v-2cd5fe7c]{padding-top:%?50?%}.auth-again uni-text[data-v-2cd5fe7c]{color:#ed6d0f;margin-right:%?40?%}.auth-again .time[data-v-2cd5fe7c]{color:#9a9a9a}@-webkit-keyframes shining-data-v-2cd5fe7c{0%{opacity:1}50%{opacity:1}50.01%{opacity:0}100%{opacity:0}}.wlIcon-QQ[data-v-2cd5fe7c]{color:#12b8f6}.wlIcon-WeChat[data-v-2cd5fe7c]{color:#02dc6b}.wlIcon-WeiBo[data-v-2cd5fe7c]{color:#d32820}.wlIcon-Xiaomi[data-v-2cd5fe7c]{color:#ff6b00}uni-page-body[data-v-2cd5fe7c]{background-color:#fff}uni-radio-group[data-v-2cd5fe7c]{display:block}.numberkeyboard[data-v-2cd5fe7c]{z-index:999}.keys .key[data-v-2cd5fe7c]{background-color:#fff}body.?%PAGE?%[data-v-2cd5fe7c]{background-color:#fff;background-color:#fff}",""]),e.exports=t},c848:function(e,t,i){"use strict";i.r(t);var n=i("cc21"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},cc21:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"WanlKeyboard",props:{open:{type:Boolean,default:!1},color:{type:String,default:"#04BE02"}},data:function(){return{config:{loop:[{number:1,key:"number-1"},{number:2,key:"number-2"},{number:3,key:"number-3"},{number:4,key:"number-4"},{number:5,key:"number-5"},{number:6,key:"number-6"},{number:7,key:"number-7"},{number:8,key:"number-8"},{number:9,key:"number-9"}]},numberKeyboardPopupVisible:this.open}},watch:{numberKeyboardPopupVisible:function(e,t){0==e&&this.$emit("close")},open:function(t,i){e.log(t),this.numberKeyboardPopupVisible=t}},methods:{close:function(){this.numberKeyboardPopupVisible=!1,this.$emit("close")},del:function(){this.$emit("delete")},empty:function(){this.$emit("empty")},number:function(e){this.$emit("number",e)}}};t.default=i}).call(this,i("5a52")["default"])},fe00:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var n={wanlKeyboard:i("2aed").default},a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{staticClass:"edgeInsetTop"}),i("v-uni-view",{staticClass:"wanl-pay"},[i("v-uni-view",{staticClass:"price-box"},[i("v-uni-text",{staticClass:"text-df"},[e._v(e._s(e.order_no))]),i("v-uni-text",{staticClass:"wanl-pip text-price margin-top-sm"},[e._v(e._s(e.price))])],1),i("v-uni-view",{staticClass:"list-box"},e._l(e.payList,(function(t,n){return i("v-uni-view",{key:n,staticClass:"item"},[i("v-uni-text",{class:"wlIcon-"+t.type+"-pay"}),i("v-uni-view",{staticClass:"action"},[i("v-uni-text",{staticClass:"title wanl-pip"},[e._v(e._s(t.name))]),"balance"==t.type?i("v-uni-view",[e.isbalance?i("v-uni-text",[e._v("可用餘額 NT$"+e._s(e.user.money))]):i("v-uni-text",[e._v("餘額不足，可用餘額 NT$"+e._s(e.user.money)),i("span",{staticStyle:{color:"red"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$wanlshop.to("/pages/user/money/money")}}},[e._v("去充值")])])],1):i("v-uni-view",[e._v(e._s(t.describe))])],1),t.state?i("v-uni-view",{staticClass:"radio text-xxl",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onSelect(n)}}},[t.select?i("v-uni-text",{staticClass:"wlIcon-xuanze-danxuan wanl-orange"}):i("v-uni-text",{staticClass:"wlIcon-xuanze wanl-gray-light"})],1):i("v-uni-view",{staticClass:"radio text-xxl"},[i("v-uni-text",{staticClass:"wlIcon-xuanze-danxuan wanl-gray-light"})],1)],1)})),1),i("v-uni-view",{staticClass:"list-box"},[i("v-uni-text",[e._v("支付密碼"),i("span",{staticStyle:{color:"red"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$wanlshop.to("/pages/user/setting/paypass")}}},[e._v("(去設置)")])]),i("v-uni-view",{staticClass:"codes"},e._l(e.config.count,(function(t){return i("v-uni-view",{key:t.key},[i("v-uni-view",{staticClass:"input",class:{active:e.currentFocus==t.index},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.hanldeOpenKeyboard.apply(void 0,arguments)}}},[void 0!=e.code[t.index-1]?[e._v(e._s(e.code[t.index-1]))]:[e.currentFocus==t.index?i("v-uni-view",{staticClass:"shining"}):e._e()]],2)],1)})),1)],1),1==e.payNum?i("v-uni-button",{staticClass:"mix-btn wanl-bg-redorange",attrs:{loading:e.loading},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm()}}},[e._v("確認支付")]):i("v-uni-button",{staticClass:"mix-btn wanl-bg-redorange",attrs:{loading:e.loading},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm()}}},[e._v("合併支付")]),i("v-uni-view",{staticClass:"footer text-center"},[e.order_pay_no?i("v-uni-view",{staticClass:"text-sm"},[e._v("交易號："+e._s(e.order_pay_no))]):e._e(),i("v-uni-view",[e._v("© shopptw支付")])],1),i("wanl-keyboard",{attrs:{open:e.keyboardVisible},on:{number:function(t){arguments[0]=t=e.$handleEvent(t),e.inputCode.apply(void 0,arguments)},delete:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteCode.apply(void 0,arguments)},empty:function(t){arguments[0]=t=e.$handleEvent(t),e.emptyCode.apply(void 0,arguments)},close:function(t){arguments[0]=t=e.$handleEvent(t),e.keyboardVisible=!1}}})],1)],1)},o=[]}}]);