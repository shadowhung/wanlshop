"use strict";define(["jquery","bootstrap","table","backend","form","vue"],function(e,t,a,i,n,r){var o={index:function(){a.api.init({extend:{index_url:"wanlshop/find/index"+location.search,add_url:"wanlshop/find/add",edit_url:"",del_url:"wanlshop/find/del",multi_url:"",table:"wanlshop_find"}});var t=e("#table");t.bootstrapTable({url:e.fn.bootstrapTable.defaults.extend.index_url,pk:"id",sortName:"id",columns:[[{checkbox:!0},{field:"id",title:__("Id")},{field:"type",title:__("Type"),searchList:{new:__("Type new"),live:__("Type live"),want:__("Type want"),activity:__("Type activity"),show:__("Type show")},formatter:a.api.formatter.normal},{field:"content",title:__("Content"),formatter:o.api.formatter.formatHtml},{field:"images",title:__("Images"),events:a.api.events.image,formatter:a.api.formatter.images},{field:"views",title:__("Views")},{field:"like",title:__("Like")},{field:"comments",title:__("Comments")},{field:"createtime",title:__("Createtime"),operate:"RANGE",addclass:"datetimerange",formatter:a.api.formatter.datetime},{field:"operate",title:__("Operate"),table:t,events:a.api.events.operate,formatter:a.api.formatter.operate}]]}),a.api.bindevent(t)},recyclebin:function(){a.api.init({extend:{dragsort_url:""}});var t=e("#table");t.bootstrapTable({url:"wanlshop/find/recyclebin"+location.search,pk:"id",sortName:"id",columns:[[{checkbox:!0},{field:"id",title:__("Id")},{field:"deletetime",title:__("Deletetime"),operate:"RANGE",addclass:"datetimerange",formatter:a.api.formatter.datetime},{field:"operate",width:"130px",title:__("Operate"),table:t,events:a.api.events.operate,buttons:[{name:"Restore",text:__("Restore"),classname:"btn btn-xs btn-info btn-ajax btn-restoreit",icon:"fa fa-rotate-left",url:"wanlshop/find/restore",refresh:!0},{name:"Destroy",text:__("Destroy"),classname:"btn btn-xs btn-danger btn-ajax btn-destroyit",icon:"fa fa-times",url:"wanlshop/find/destroy",refresh:!0}],formatter:a.api.formatter.operate}]]}),a.api.bindevent(t)},add:function(){o.api.bindevent();var e=new r({el:"#app",data:function(){return{type:Config.type,isHead:Config.ishead,typeList:{new:"上新",live:"直播",want:"種草",activity:"活動",show:"買家秀"},imgList:[],goodsList:[],commentsData:null}},methods:{getTypeName:function(e){return this.typeList[e]},delImg:function(t){r.delete(e.imgList,t)},addImg:function(){var e=this;parent.Fast.api.open("wanlshop/attachment/select?element_id=fachoose-image&multiple=true&mimetype=image/*",__("選擇圖片"),{callback:function(t){if(t.url){var a=t.url.split(",");a.length>9&&layer.msg("最多上傳9張圖片，超出自動刪除"),e.imgList=a.slice(0,9)}}})},delGoods:function(t){r.delete(e.goodsList,t)},addGoods:function(){var e=this;parent.Fast.api.open("wanlshop/goods/select?multiple=true",__("選擇商品"),{callback:function(t){e.goodsList=t.data}})},delComments:function(){this.commentsData=null},addComments:function(){var e=this;parent.Fast.api.open("wanlshop/comment/select?multiple=flase",__("選擇評論"),{callback:function(t){e.commentsData=t.data}})},cdnurl:function(e){return Fast.api.cdnurl(e)}}})},api:{formatter:{formatHtml:function(e,t,a){var i={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(e,t){return i[t]}).replace(/<\/?.+?>/g,"").replace(/ /g,"").substring(0,12)+"..."}},bindevent:function(){n.api.bindevent(e("form[role=form]"))}}};return o});