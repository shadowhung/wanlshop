(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-product-search"],{"09b2":function(t,e,s){"use strict";var i=s("4ea4");s("a434"),s("ac1f"),s("841c"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,s("96cf");var n=i(s("1da1")),a={data:function(){return{wanlsys:this.$wanlshop.wanlsys(),searchKeywords:"",isHistory:!0,searchList:{},historyList:[],search:{categoryList:{},searchList:{}}}},onReady:function(){this.loadData(),this.historyList=uni.getStorageSync("search:history")},onLoad:function(t){t.keywords&&(this.searchKeywords=t.keywords)},methods:{loadData:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$api.get({url:"/wanlshop/common/searchList",success:function(e){t.searchList=e}});case 1:case"end":return e.stop()}}),e)})))()},loadSearch:function(t){var e=this;return(0,n.default)(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:e.$api.get({url:"/wanlshop/common/search",data:{search:t},success:function(t){e.search=t,0==t.categoryList.length&&0==t.searchList.length||(e.isHistory=!1)}});case 1:case"end":return s.stop()}}),s)})))()},setSearch:function(t){var e=this;return(0,n.default)(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:e.$api.get({url:"/wanlshop/common/setSearch",data:{keywords:t}});case 1:case"end":return s.stop()}}),s)})))()},setHistory:function(t){this.setSearch(t),this.loadData();var e=uni.getStorageSync("search:history");this.historyList=[],this.historyList=e;var s=e;s||(s=[]);var i={};i="string"===typeof t?{keywords:t}:t;for(var n=0;n<s.length;n++)if(s[n].keywords===i.keywords){s.splice(n,1);break}s.unshift(i),uni.setStorage({key:"search:history",data:s})},removeHistory:function(){var t=this;uni.showModal({title:"提示",content:"是否清理全部搜索曆史？该操作不可逆。",success:function(e){e.confirm&&(t.historyList=[],uni.removeStorage({key:"search:history"}))}})},keywordsToList:function(t){this.setHistory(t),this.$wanlshop.to("/pages/product/list?search=".concat(t))},categoryToList:function(t,e){this.setHistory(e),this.$wanlshop.to("/pages/product/list?data=".concat(JSON.stringify({category_id:t,category_name:e})))},onSearchInputChanged:function(t){var e=t.detail.value;e?this.loadSearch(e):this.isHistory=!0},onSearchInputConfirmed:function(t){var e=t.detail.value;if(e)this.isHistory=!0,uni.hideKeyboard(),this.historyList=[],this.historyList=uni.getStorageSync("search:history"),this.keywordsToList(e);else{if(this.isHistory=!0,!this.searchKeywords)return void uni.showModal({title:"提示",content:"請输入内容。"});this.keywordsToList(this.searchKeywords)}}}};e.default=a},"2b75":function(t,e,s){var i=s("eb9f");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=s("4f06").default;n("19a3284c",i,!0,{sourceMap:!1,shadowMode:!1})},4134:function(t,e,s){"use strict";var i;s.d(e,"b",(function(){return n})),s.d(e,"c",(function(){return a})),s.d(e,"a",(function(){return i}));var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-uni-view",{staticClass:"wanl-search"},[s("v-uni-view",{staticClass:"cu-custom",style:{height:t.wanlsys.height+"px"}},[s("v-uni-view",{staticClass:"cu-bar fixed",style:{height:t.wanlsys.height+"px",paddingTop:t.wanlsys.top+"px"}},[s("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$wanlshop.back(1)}}},[s("v-uni-text",{staticClass:"wlIcon-fanhui1"})],1),s("v-uni-view",{staticClass:"search-form round"},[s("v-uni-text",{staticClass:"wlIcon-sousuo1 text-bold"}),s("v-uni-input",{attrs:{type:"text","confirm-type":"search","placeholder-style":"color: #ccc",placeholder:t.searchKeywords?t.searchKeywords:"搜索商品、類目",focus:!0},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.onSearchInputConfirmed.apply(void 0,arguments)},input:function(e){arguments[0]=e=t.$handleEvent(e),t.onSearchInputChanged.apply(void 0,arguments)}}})],1)],1)],1),t.isHistory?s("v-uni-view",{staticClass:"history padding-lr"},[t.historyList.length>0?s("v-uni-view",[s("v-uni-view",{staticClass:"title"},[s("v-uni-text",[t._v("曆史搜索")]),s("v-uni-text",{staticClass:"wlIcon-lajitong",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.removeHistory.apply(void 0,arguments)}}})],1),s("v-uni-view",{staticClass:"list"},t._l(t.historyList,(function(e,i){return s("v-uni-view",{key:e.keywords,on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.keywordsToList(e.keywords)}}},[t._v(t._s(e.keywords))])})),1)],1):t._e(),s("v-uni-view",[s("v-uni-view",{staticClass:"title"},[s("v-uni-text",[t._v("热门搜索")]),s("v-uni-text",{staticClass:"wlIcon-guanzhu"})],1),s("v-uni-view",{staticClass:"list"},[t._l(t.searchList,(function(e,i){return["hot"==e.flag?s("v-uni-view",{key:e.id+"_0",staticClass:"action",on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.keywordsToList(e.keywords)}}},[s("v-uni-text",[t._v(t._s(e.keywords))]),s("v-uni-text",{staticClass:"cu-tag badge"},[t._v("hot")])],1):s("v-uni-view",{on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.keywordsToList(e.keywords)}}},[s("v-uni-text",[t._v(t._s(e.keywords))])],1)]}))],2)],1)],1):s("v-uni-view",{staticClass:"cu-list menu"},[t._l(t.search.searchList,(function(e,i){return s("v-uni-view",{key:e.keywords,staticClass:"cu-item"},[s("v-uni-view",{staticClass:"content",on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.keywordsToList(e.keywords)}}},[s("v-uni-text",{staticClass:"text-sm"},[t._v(t._s(e.keywords))])],1)],1)})),t._l(t.search.categoryList,(function(e,i){return s("v-uni-view",{key:e.id,staticClass:"cu-item arrow",on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.categoryToList(e.id,e.name)}}},[s("v-uni-view",{staticClass:"content"},[s("v-uni-text",{staticClass:"text-sm text-gray"},[t._v(t._s(e.name))])],1),s("v-uni-view",{staticClass:"action"},[s("v-uni-view",{staticClass:"cu-tag round bg-orange light"},[t._v(t._s(e.name)+"類目")])],1)],1)}))],2)],1)},a=[]},"8da6":function(t,e,s){"use strict";s.r(e);var i=s("09b2"),n=s.n(i);for(var a in i)"default"!==a&&function(t){s.d(e,t,(function(){return i[t]}))}(a);e["default"]=n.a},bf08:function(t,e,s){"use strict";s.r(e);var i=s("4134"),n=s("8da6");for(var a in n)"default"!==a&&function(t){s.d(e,t,(function(){return n[t]}))}(a);s("de54");var r,o=s("f0c5"),c=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"6d543eba",null,!1,i["a"],r);e["default"]=c.exports},de54:function(t,e,s){"use strict";var i=s("2b75"),n=s.n(i);n.a},eb9f:function(t,e,s){var i=s("24fb");e=i(!1),e.push([t.i,"uni-page-body[data-v-6d543eba]{background:#fff}.cu-custom .search-form[data-v-6d543eba]{border:%?3?% solid #fe6600;background-color:#fff;margin-left:0;margin-right:%?25?%}body.?%PAGE?%[data-v-6d543eba]{background:#fff}",""]),t.exports=e}}]);