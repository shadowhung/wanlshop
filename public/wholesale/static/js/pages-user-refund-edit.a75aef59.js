(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-refund-edit"],{"022f":function(e,t,n){"use strict";var a=n("4ea4");n("99af"),n("a434"),n("e25e"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("96cf");var i=a(n("1da1")),s={data:function(){return{refund:{expressType:-1,type:-1,reason:-1,images:[],goods:{},freight_type:0},expressList:["未收到貨","已收到貨"],typeList:["我要退款(無需退貨)","退貨退款"],reasonList:["不喜歡","空包裹","一直未送达","颜色/尺碼不符","质量问题","少件漏發","假冒品牌"],amount:{total:0,freight:0,info:""}}},onLoad:function(e){this.loadData(e.id)},methods:{loadData:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$api.get({url:"/wanlshop/refund/getRefundInfo",data:{id:e},success:function(e){t.refund=e;var n=e.goods.price*e.goods.number,a=parseInt(e.goods.freight_price);t.amount.freight=a,1==e.goods_number||2==e.freight_type?(t.amount.info="最多退款".concat(n+a,"元，包含运费").concat(a,"元"),t.amount.total=n+a):(t.amount.info="最多退".concat(n,"元，运费策略不含运费").concat(a,"元"),t.amount.total=n)}});case 1:case"end":return n.stop()}}),n)})))()},addData:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.refund.price<=0)){t.next=3;break}return e.$wanlshop.msg("价格不能為空"),t.abrupt("return",!1);case 3:if(!(e.refund.price>e.amount.total)){t.next=6;break}return e.$wanlshop.msg("退款不能超过￥"+e.amount.total+"元"),t.abrupt("return",!1);case 6:e.$api.post({url:"/wanlshop/refund/editRefund",data:{id:e.refund.id,expressType:e.refund.expressType,type:e.refund.type,reason:e.refund.reason,price:e.refund.price,images:e.refund.images,refund_content:e.refund.refund_content},success:function(t){e.$wanlshop.to("/pages/user/refund/details?id=".concat(t))}});case 7:case"end":return t.stop()}}),t)})))()},moneyInput:function(e){var t=e.detail.value;t>this.amount.total&&this.$wanlshop.msg("退款不能超过￥"+this.amount.total+"元"),this.refund.price=t},expressChange:function(e){this.refund.expressType=e.detail.value},typeChange:function(e){this.refund.type=e.detail.value},reasonChange:function(e){this.refund.reason=e.detail.value},chooseImage:function(e){var t=this;uni.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(e){t.$api.get({url:"/wanlshop/common/uploadData",success:function(n){for(var a=0;a<e.tempFilePaths.length;a++)uni.getImageInfo({src:e.tempFilePaths[a],success:function(e){t.$api.upload({url:n.uploadurl,filePath:e.path,name:"file",formData:"local"==n.storage?null:n.multipart,success:function(e){t.refund.images.push(e.fullurl)}})}})}})}})},viewImage:function(e){uni.previewImage({urls:this.refund.images,current:this.refund.images[e]})},delImg:function(e){this.refund.images.splice(e,1)}}};t.default=s},"0627":function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("v-uni-view",{staticClass:"edgeInsetTop"}),n("v-uni-view",{staticClass:"bg-white padding-bj flex"},[n("v-uni-view",{staticClass:"cu-avatar xl margin-right-bj",style:{backgroundImage:"url("+e.$wanlshop.oss(e.refund.goods.image,70,70)+")"}}),n("v-uni-view",{staticClass:"text-sm",staticStyle:{width:"calc(100% - 128rpx)"}},[n("v-uni-view",{staticClass:"margin-bottom-xs"},[n("v-uni-view",{staticClass:"text-cut-2"},[e._v(e._s(e.refund.goods.title))])],1),n("v-uni-view",{staticClass:"wanl-gray"},[e._v("规格："+e._s(e.refund.goods.difference))])],1)],1),n("v-uni-view",{staticClass:"margin-top-bj"},[n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[e._v("物流状态")]),n("v-uni-picker",{attrs:{value:e.refund.expressType,range:e.expressList},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.expressChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.expressList[e.refund.expressType]))])],1)],1),n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[e._v("退款類型")]),n("v-uni-picker",{attrs:{value:e.refund.type,range:e.typeList},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.typeChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.typeList[e.refund.type]))])],1)],1),n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[e._v("退款原因")]),n("v-uni-picker",{attrs:{value:e.refund.reason,range:e.reasonList},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.reasonChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.reasonList[e.refund.reason]))])],1)],1),n("v-uni-view",{staticClass:"cu-form-group margin-top-bj"},[n("v-uni-view",{staticClass:"title"},[e._v("退款金额"),n("v-uni-text",{staticClass:"text-price margin-left-xs"})],1),n("v-uni-input",{attrs:{type:"digit",placeholder:e.amount.info,value:e.refund.price,disabled:0==e.amount.total},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.moneyInput.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"bg-white margin-top-bj"},[n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[e._v("上傳凭證")])],1),n("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub padding-lr"},[e._l(e.refund.images,(function(t,a){return n("v-uni-view",{key:a,staticClass:"bg-img",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.viewImage(a)}}},[n("v-uni-image",{attrs:{src:e.$wanlshop.oss(t,90,90),mode:"aspectFill"}}),n("v-uni-view",{staticClass:"cu-tag bg-red",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.delImg(a)}}},[n("v-uni-text",{staticClass:"wlIcon-31guanbi"})],1)],1)})),e.refund.images.length<4?n("v-uni-view",{staticClass:"dashed",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"wlIcon-31paishe"})],1):e._e()],2)],1),n("v-uni-view",{staticClass:"cu-form-group margin-top-bj"},[n("v-uni-view",{staticClass:"title"},[e._v("退款理由")]),n("v-uni-input",{attrs:{placeholder:"选填"},model:{value:e.refund.refund_content,callback:function(t){e.$set(e.refund,"refund_content",t)},expression:"refund.refund_content"}})],1)],1),n("v-uni-view",{staticClass:"edgeInsetBottom"}),n("v-uni-view",{staticClass:"wanlian cu-bar tabbar foot flex flex-direction"},[n("v-uni-button",{staticClass:"cu-btn wanl-bg-orange lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.addData.apply(void 0,arguments)}}},[e._v("确认")])],1)],1)},s=[]},"0c19":function(e,t,n){"use strict";n.r(t);var a=n("022f"),i=n.n(a);for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);t["default"]=i.a},"0dcd":function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,".dashed[data-v-7cbcf7d9]::after{border:1px dashed #666}.cu-btn.lg[data-v-7cbcf7d9]{width:calc(100% - %?50?%)}",""]),e.exports=t},1545:function(e,t,n){"use strict";var a=n("2427"),i=n.n(a);i.a},2427:function(e,t,n){var a=n("0dcd");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("4f06").default;i("1b2aa1fd",a,!0,{sourceMap:!1,shadowMode:!1})},5261:function(e,t,n){"use strict";n.r(t);var a=n("0627"),i=n("0c19");for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("1545");var u,r=n("f0c5"),o=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"7cbcf7d9",null,!1,a["a"],u);t["default"]=o.exports}}]);